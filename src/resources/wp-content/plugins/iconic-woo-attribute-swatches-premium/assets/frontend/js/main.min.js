! function(v, s) {
    var d = {
        cache: function() {
            d.els = {}, d.vars = {}, d.vars.swatch_group_class = ".iconic-was-swatches", d.vars.swatch_class = ".iconic-was-swatch", d.vars.selected_class = "iconic-was-swatch--selected", d.vars.disabled_class = "iconic-was-swatch--disabled", d.vars.follow_class = "iconic-was-swatch--follow", d.vars.variations_form_class = ".variations_form", d.vars.attribute_labels_class = ".variations .label", d.vars.chosen_attribute_class = ".iconic-was-chosen-attribute", d.vars.attribute_selects_selector = ".variations select", d.vars.change_image_links_class = ".iconic-was-swatch--change-image"
        },
        on_ready: function() {
            d.cache(), d.setup_swatches(), d.setup_change_image_links(), d.setup_fees()
        },
        setup_swatches: function() {
            v(s).on("click", d.vars.swatch_class, function(s) {
                var a = v(this),
                    e = a.closest(d.vars.variations_form_class),
                    t = a.closest(d.vars.swatch_group_class).data("attribute"),
                    c = a.data("attribute-value"),
                    r = e.find('select[id="' + t.replace("attribute_", "") + '"]'),
                    n = r.attr("name"),
                    i = a.closest(".value").prev(".label").find(d.vars.chosen_attribute_class),
                    l = (a.hasClass("iconic-was-swatch--colour-swatch") || a.hasClass("iconic-was-swatch--image-swatch"), d.get_current_values(e)),
                    o = !1;
                if (a.hasClass(d.vars.follow_class)) return !0;
                if (a.hasClass(d.vars.disabled_class) && (d.reset_form(s, e), delete l[n], o = !0), r.trigger("focusin"), a.hasClass(d.vars.selected_class)) return a.removeClass(d.vars.selected_class), d.select_value(r, ""), void i.text("");
                var _ = !1 === v(d.vars.variations_form_class).data("product_variations"),
                    u = '[value="' + d.esc_double_quotes(c) + '"]';
                return _ || (u = ".enabled" + u), 0 < r.find(u).length && (d.deselect_swatch_group(e, t), a.addClass(d.vars.selected_class), d.select_value(r, c), void(o && d.select_values(e, l)))
            }), v(s).on("mouseenter mouseleave", d.vars.swatch_class, function(s) {
                var a = v(this).closest(d.vars.swatch_group_class).next("div").find("select");
                a.length <= 0 || a.trigger("focusin")
            }), v(s).on("woocommerce_update_variation_values", d.vars.variations_form_class, function() {
                var c = v(this);
                c.find("select").each(function(s) {
                    var a = v(this),
                        e = a.find("option"),
                        t = a.data("attribute_name"),
                        r = c.find(d.vars.swatch_group_class + '[data-attribute="' + d.esc_double_quotes(t) + '"]');
                    r.find(d.vars.swatch_class).addClass(d.vars.disabled_class), e.each(function(s, a) {
                        var e = v(a),
                            t = e.val(),
                            c = r.find('[data-attribute-value="' + d.esc_double_quotes(t) + '"]');
                        e.hasClass("enabled") ? c.removeClass(d.vars.disabled_class) : c.removeClass(d.vars.selected_class)
                    })
                })
            }), v(s).on("change", d.vars.attribute_selects_selector, function() {
                d.change_label(v(this))
            }), v(s).on("click", ".reset_variations", function(s) {
                var a = v(this).closest(d.vars.variations_form_class);
                d.reset_form(s, a)
            }), v(s).on("check_variations", "form.variations_form", function() {
                var s = v(this).find("." + d.vars.disabled_class);
                s.length <= 0 || s.hasClass(d.vars.selected_class) && (s.closest("tr").find(d.vars.chosen_attribute_class).text(""), s.removeClass(d.vars.selected_class))
            }), d.swatches_on_load()
        },
        select_values: function(r, n) {
            var s = r.find("select");
            if (s.length <= 0) return !1;
            s.each(function(s, a) {
                var e = v(this),
                    t = e.attr("name");
                if (void 0 !== n[t]) {
                    var c = e.find('option[value="' + d.esc_double_quotes(n[t]) + '"]');
                    c.length <= 0 || c.hasClass("enabled") && (d.select_value(e, n[t]), r.find(d.vars.swatch_class + '[data-attribute-value="' + d.esc_double_quotes(n[t]) + '"]').click())
                }
            })
        },
        reset_form: function(s, a) {
            s.preventDefault(), a.find(d.vars.attribute_selects_selector).find("option").prop("selected", !1).end().change().end().find(d.vars.swatch_class).removeClass(d.vars.selected_class).end().find(d.vars.attribute_labels_class + " " + d.vars.chosen_attribute_class).text("").end().trigger("reset_data"), d.deselect_all_swatch_groups(a)
        },
        get_current_values: function(s) {
            var t = {},
                a = s.find("select");
            return !(a.length <= 0) && (a.each(function() {
                var s = v(this),
                    a = s.attr("name"),
                    e = s.val();
                e && "" !== e && (t[a] = e)
            }), t)
        },
        deselect_swatch_group: function(s, a) {
            s.find('[data-attribute="' + d.esc_double_quotes(a) + '"] ' + d.vars.swatch_class).removeClass(d.vars.selected_class)
        },
        deselect_all_swatch_groups: function(s) {
            s.find(d.vars.swatch_class).removeClass(d.vars.selected_class)
        },
        swatches_on_load: function() {
            var s = v(".variations select").find(":selected");
            s.length <= 0 || s.each(function() {
                var s = v(this).closest("select");
                d.change_label(s)
            })
        },
        select_value: function(s, a) {
            s.val(a).change()
        },
        change_label: function(s) {
            var a = s.val(),
                e = s.closest(".value"),
                t = e.find(d.vars.swatch_class + '[data-attribute-value="' + a + '"]'),
                c = e.prev(".label").find(d.vars.chosen_attribute_class),
                r = 0 < t.length ? t.data("attribute-value-name") : s.find('option[value="' + d.esc_double_quotes(a) + '"]').text();
            "" !== a && void 0 !== r && c.text(r)
        },
        setup_change_image_links: function() {
            v(s).on("click", d.vars.change_image_links_class, function() {
                var s = v(this),
                    a = s.attr("href"),
                    e = s.data("srcset"),
                    t = s.data("sizes");
                return s.closest(".product").find("img:first").attr("src", a).attr("srcset", e).attr("sizes", t), !1
            })
        },
        esc_double_quotes: function(s) {
            return String(s).replace(/"/g, '\\"')
        },
        setup_fees: function() {
            v(s.body).on("change", 'input[name="variation_id"]', function() {
                var s = v(this);
                if ("" !== s.val()) {
                    var a = s.closest("form"),
                        e = a.find(".woocommerce-variation-price"),
                        t = e.find("del"),
                        c = 0 < t.length ? t.find(".amount") : e.find(".amount"),
                        r = 0 < t.length && e.find("ins .amount"),
                        n = d.get_price_with_fees(a, c, r);
                    n && e.html(n)
                }
            })
        },
        get_price_with_fees: function(s, a, e) {
            if (e = e || !1, s.length <= 0 || a.length <= 0) return !1;
            var t = s.find(".iconic-was-fees");
            if (t.length <= 0) return !1;
            var c = JSON.parse(t.text()),
                r = accounting.unformat(a.text(), iconic_was_vars.currency.format_decimal_sep),
                n = !!e && accounting.unformat(e.text(), iconic_was_vars.currency.format_decimal_sep),
                i = d.get_attributes_from_form(s);
            v.each(i, function(s, a) {
                void 0 !== c[s] && void 0 !== c[s][a] && (r += c[s][a], !1 !== n && (n += c[s][a]))
            });
            var l = accounting.formatMoney(r, {
                symbol: iconic_was_vars.currency.format_symbol,
                decimal: iconic_was_vars.currency.format_decimal_sep,
                thousand: iconic_was_vars.currency.format_thousand_sep,
                precision: iconic_was_vars.currency.format_num_decimals,
                format: iconic_was_vars.currency.format
            });
            return !1 !== n && (l = "<del>" + l + "</del> ", l += "<ins>" + accounting.formatMoney(n, {
                symbol: iconic_was_vars.currency.format_symbol,
                decimal: iconic_was_vars.currency.format_decimal_sep,
                thousand: iconic_was_vars.currency.format_thousand_sep,
                precision: iconic_was_vars.currency.format_num_decimals,
                format: iconic_was_vars.currency.format
            }) + "</ins>"), l
        },
        get_attributes_from_form: function(s) {
            var t = {},
                a = s.serializeArray();
            return a.length <= 0 || v.each(a, function(s, a) {
                if ("" !== a.value && a.name.startsWith("attribute_")) {
                    var e = a.name.replace("attribute_", "");
                    t[e] = a.value
                }
            }), t
        }
    };
    v(s).ready(d.on_ready())
}(jQuery, document);